/* ─── JustDetox shared components ────────────────────────────────────────────
 *
 * Button, Input, SegmentedControl, Toggle, Card, ListRow, Modal
 * ─────────────────────────────────────────────────────────────────────────── */

/* ══════════════════════════════════════════════════════════════════════════════
   BUTTON
   ══════════════════════════════════════════════════════════════════════════════ */

/* Base styles applied to .btn OR any variant class directly */
.btn,
.btn-primary,
.btn-secondary,
.btn-ghost,
.btn-danger {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: var(--sp-2);
  padding: 0 var(--sp-4);
  height: 32px;
  font-size: var(--text-sm);
  font-weight: var(--weight-medium);
  font-family: var(--font);
  letter-spacing: 0.01em;
  border-radius: var(--r-sm);
  border: 1px solid transparent;
  white-space: nowrap;
  cursor: pointer;
  transition:
    background var(--dur-base) var(--ease-out),
    border-color var(--dur-base) var(--ease-out),
    color var(--dur-base) var(--ease-out),
    opacity var(--dur-base) var(--ease-out);
  user-select: none;
  text-decoration: none;
}

/* Also apply to btn with any modifier */
.btn {
  /* base only, used when variant is also present */
}

.btn:focus-visible {
  outline: 2px solid var(--border-focus);
  outline-offset: 2px;
}

.btn:disabled {
  opacity: 0.38;
  cursor: not-allowed;
  pointer-events: none;
}

/* Primary — white fill */
.btn-primary {
  background: var(--text-1);
  color: var(--bg);
  border-color: var(--text-1);
}
.btn-primary:hover:not(:disabled) { opacity: 0.88; }
.btn-primary:active:not(:disabled) { opacity: 0.76; }

/* Secondary — outlined */
.btn-secondary {
  background: transparent;
  color: var(--text-2);
  border-color: var(--border-strong);
}
.btn-secondary:hover:not(:disabled) {
  background: var(--surface-3);
  color: var(--text-1);
  border-color: var(--surface-4);
}
.btn-secondary:active:not(:disabled) { background: var(--surface-4); }

/* Ghost — no border */
.btn-ghost {
  background: transparent;
  color: var(--text-3);
  border-color: transparent;
}
.btn-ghost:hover:not(:disabled) {
  background: var(--surface-3);
  color: var(--text-1);
}
.btn-ghost:active:not(:disabled) { background: var(--surface-4); }

/* Danger */
.btn-danger {
  background: transparent;
  color: var(--text-3);
  border-color: var(--border-strong);
}
.btn-danger:hover:not(:disabled) {
  color: var(--text-danger);
  border-color: var(--text-danger);
  background: transparent;
}

/* Size variants */
.btn--sm {
  height: 26px;
  padding: 0 var(--sp-3);
  font-size: var(--text-xs);
}

.btn--lg {
  height: 40px;
  padding: 0 var(--sp-6);
  font-size: var(--text-base);
  font-weight: var(--weight-semi);
  border-radius: var(--r-md);
}

/* Icon-only button */
.btn--icon {
  width: 32px;
  padding: 0;
}
.btn--icon.btn--sm { width: 26px; }


/* ══════════════════════════════════════════════════════════════════════════════
   INPUT
   ══════════════════════════════════════════════════════════════════════════════ */

.input-wrap {
  display: flex;
  flex-direction: column;
  gap: var(--sp-1);
}

.input-label {
  font-size: var(--text-sm);
  font-weight: var(--weight-medium);
  color: var(--text-2);
}

.input {
  width: 100%;
  height: 34px;
  padding: 0 var(--sp-3);
  background: var(--surface-2);
  border: 1px solid var(--border-strong);
  border-radius: var(--r-sm);
  font-family: var(--font);
  font-size: var(--text-base);
  color: var(--text-1);
  transition: border-color var(--dur-base) var(--ease-out);
}

.input::placeholder { color: var(--text-3); }

.input:hover { border-color: var(--surface-4); }

.input:focus {
  outline: none;
  border-color: var(--border-focus);
}

.input--error { border-color: var(--text-danger) !important; }

.input-hint {
  font-size: var(--text-xs);
  color: var(--text-3);
}

.input-error {
  font-size: var(--text-xs);
  color: var(--text-danger);
}

/* Number input (used for limit minutes) */
.input[type="number"] { -moz-appearance: textfield; }
.input[type="number"]::-webkit-outer-spin-button,
.input[type="number"]::-webkit-inner-spin-button { -webkit-appearance: none; }


/* ══════════════════════════════════════════════════════════════════════════════
   SEGMENTED CONTROL
   ══════════════════════════════════════════════════════════════════════════════ */

.seg {
  display: inline-flex;
  align-items: center;
  gap: var(--sp-1);
  padding: var(--sp-1);
  background: var(--surface-2);
  border: 1px solid var(--border);
  border-radius: var(--r-sm);
}

.seg__option {
  padding: var(--sp-1) var(--sp-3);
  font-size: var(--text-sm);
  font-weight: var(--weight-medium);
  color: var(--text-3);
  border-radius: 6px;
  border: 1px solid transparent;
  cursor: pointer;
  transition:
    background var(--dur-base) var(--ease-out),
    color var(--dur-base) var(--ease-out);
  white-space: nowrap;
  user-select: none;
}

.seg__option:hover:not(.seg__option--active) {
  color: var(--text-2);
  background: var(--surface-3);
}

.seg__option--active {
  background: var(--surface-4);
  color: var(--text-1);
  border-color: var(--border-strong);
}

/* Full-width variant */
.seg--full { width: 100%; }
.seg--full .seg__option { flex: 1; text-align: center; }


/* ══════════════════════════════════════════════════════════════════════════════
   TOGGLE SWITCH
   ══════════════════════════════════════════════════════════════════════════════ */

.toggle {
  position: relative;
  display: inline-block;
  width: 36px;
  height: 20px;
  cursor: pointer;
  flex-shrink: 0;
}

.toggle__input {
  position: absolute;
  opacity: 0;
  width: 0;
  height: 0;
}

.toggle__track {
  position: absolute;
  inset: 0;
  background: var(--surface-3);
  border: 1px solid var(--border-strong);
  border-radius: 10px;
  transition: background var(--dur-base) var(--ease-out);
}

.toggle__thumb {
  position: absolute;
  top: 3px;
  left: 3px;
  width: 12px;
  height: 12px;
  background: var(--text-3);
  border-radius: 50%;
  transition:
    left var(--dur-base) var(--ease-out),
    background var(--dur-base) var(--ease-out);
}

/* On state */
.toggle__input:checked ~ .toggle__track {
  background: var(--surface-4);
  border-color: var(--border-strong);
}

.toggle__input:checked ~ .toggle__track .toggle__thumb {
  left: 19px;
  background: var(--text-1);
}

/* Focus */
.toggle__input:focus-visible ~ .toggle__track {
  outline: 2px solid var(--border-focus);
  outline-offset: 2px;
}

/* Disabled */
.toggle--disabled { opacity: 0.38; pointer-events: none; }


/* ══════════════════════════════════════════════════════════════════════════════
   CARD
   ══════════════════════════════════════════════════════════════════════════════ */

.card {
  background: var(--surface-1);
  border: 1px solid var(--border);
  border-radius: var(--r-md);
  overflow: hidden;
}

.card--raised {
  background: var(--surface-2);
  border-color: var(--border-strong);
}

.card--interactive {
  cursor: pointer;
  transition: border-color var(--dur-base) var(--ease-out);
}

.card--interactive:hover { border-color: var(--border-strong); }
.card--interactive:focus-visible {
  outline: 2px solid var(--border-focus);
  outline-offset: 2px;
}


/* ══════════════════════════════════════════════════════════════════════════════
   LIST ROW
   ══════════════════════════════════════════════════════════════════════════════ */

.list { display: flex; flex-direction: column; }

.list-row {
  display: flex;
  align-items: center;
  gap: var(--sp-3);
  padding: 0 var(--sp-4);
  min-height: 48px;
  border-bottom: 1px solid var(--border);
  transition: background var(--dur-fast) var(--ease-out);
  cursor: default;
}

.list-row:last-child { border-bottom: none; }

.list-row--interactive {
  cursor: pointer;
}

.list-row--interactive:hover { background: var(--surface-2); }
.list-row--interactive:active { background: var(--surface-3); }

.list-row__main {
  flex: 1;
  min-width: 0;
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.list-row__title {
  font-size: var(--text-base);
  font-weight: var(--weight-medium);
  color: var(--text-1);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.list-row__sub {
  font-size: var(--text-sm);
  color: var(--text-3);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.list-row__aside {
  display: flex;
  align-items: center;
  gap: var(--sp-2);
  flex-shrink: 0;
}

/* Disabled row */
.list-row--disabled { opacity: 0.4; }

/* Badge (mode label: block / limit) */
.badge {
  display: inline-flex;
  align-items: center;
  padding: 2px var(--sp-2);
  background: var(--surface-3);
  border: 1px solid var(--border-strong);
  border-radius: 6px;
  font-size: var(--text-xs);
  font-weight: var(--weight-medium);
  color: var(--text-2);
  white-space: nowrap;
}


/* ══════════════════════════════════════════════════════════════════════════════
   MODAL / DRAWER
   ══════════════════════════════════════════════════════════════════════════════ */

.modal-backdrop {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.72);
  z-index: 200;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: var(--sp-6);
  animation: backdrop-in var(--dur-slow) var(--ease-out) both;
}

@keyframes backdrop-in {
  from { opacity: 0; }
  to   { opacity: 1; }
}

.modal-box {
  background: var(--surface-2);
  border: 1px solid var(--border-strong);
  border-radius: var(--r-lg);
  width: 100%;
  max-width: 480px;
  max-height: 88vh;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  animation: modal-in var(--dur-slow) var(--ease-out) both;
}

@keyframes modal-in {
  from { opacity: 0; transform: translateY(6px) scale(0.98); }
  to   { opacity: 1; transform: translateY(0) scale(1); }
}

.modal-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--sp-4) var(--sp-6);
  border-bottom: 1px solid var(--border);
  flex-shrink: 0;
}

.modal-title {
  font-size: var(--text-md);
  font-weight: var(--weight-semi);
  color: var(--text-1);
}

.modal-body {
  padding: var(--sp-6);
  display: flex;
  flex-direction: column;
  gap: var(--sp-4);
  flex: 1;
}

.modal-footer {
  padding: var(--sp-4) var(--sp-6);
  border-top: 1px solid var(--border);
  display: flex;
  justify-content: flex-end;
  gap: var(--sp-2);
  flex-shrink: 0;
}


/* ══════════════════════════════════════════════════════════════════════════════
   DOMAIN PILL INPUT
   ══════════════════════════════════════════════════════════════════════════════ */

.pill-box {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: var(--sp-2);
  padding: var(--sp-2) var(--sp-3);
  background: var(--surface-2);
  border: 1px solid var(--border-strong);
  border-radius: var(--r-sm);
  min-height: 38px;
  cursor: text;
  transition: border-color var(--dur-base) var(--ease-out);
}

.pill-box:focus-within { border-color: var(--border-focus); }

.pill {
  display: inline-flex;
  align-items: center;
  gap: var(--sp-1);
  padding: 2px var(--sp-1) 2px var(--sp-2);
  background: var(--surface-3);
  border: 1px solid var(--border-strong);
  border-radius: 6px;
}

.pill__label {
  font-size: var(--text-sm);
  color: var(--text-1);
  white-space: nowrap;
  font-family: var(--font-mono);
  font-size: var(--text-xs);
  letter-spacing: 0.01em;
}

.pill__remove {
  background: none;
  border: none;
  color: var(--text-3);
  font-size: 14px;
  line-height: 1;
  padding: 0 2px;
  cursor: pointer;
  transition: color var(--dur-fast);
  display: flex;
  align-items: center;
}

.pill__remove:hover { color: var(--text-danger); }

.pill-input {
  background: none;
  border: none;
  outline: none;
  color: var(--text-1);
  font-size: var(--text-sm);
  min-width: 120px;
  flex: 1;
  font-family: var(--font-mono);
}

.pill-input::placeholder { color: var(--text-3); }


/* ══════════════════════════════════════════════════════════════════════════════
   EMPTY STATE
   ══════════════════════════════════════════════════════════════════════════════ */

.empty-state {
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  justify-content: center;
  gap: var(--sp-3);
  padding: var(--sp-8) var(--sp-4);
  color: var(--text-3);
}

.empty-state__heading {
  font-size: var(--text-base);
  font-weight: var(--weight-medium);
  color: var(--text-2);
}

.empty-state__body {
  font-size: var(--text-sm);
  line-height: var(--lh-loose);
  max-width: 340px;
}


/* ══════════════════════════════════════════════════════════════════════════════
   FORM PRIMITIVES
   ══════════════════════════════════════════════════════════════════════════════ */

.field {
  display: flex;
  flex-direction: column;
  gap: var(--sp-1);
}

.field__label {
  font-size: var(--text-sm);
  font-weight: var(--weight-medium);
  color: var(--text-2);
}

.field__hint {
  font-size: var(--text-xs);
  color: var(--text-3);
  line-height: var(--lh-base);
}

.field__error {
  font-size: var(--text-xs);
  color: var(--text-danger);
}

/* Row with two fields side by side */
.field-row {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: var(--sp-4);
}


/* ══════════════════════════════════════════════════════════════════════════════
   BAR CHART
   ══════════════════════════════════════════════════════════════════════════════ */

.bar-list {
  display: flex;
  flex-direction: column;
  gap: var(--sp-3);
}

.bar-item {
  display: grid;
  grid-template-columns: 160px 1fr 56px;
  align-items: center;
  gap: var(--sp-3);
}

.bar-item__label {
  font-size: var(--text-sm);
  color: var(--text-2);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.bar-item__sublabel {
  font-size: var(--text-xs);
  color: var(--text-3);
  white-space: nowrap;
  margin-top: 1px;
}

.bar-track {
  height: 4px;
  background: var(--surface-3);
  border-radius: 2px;
  overflow: hidden;
}

.bar-fill {
  height: 100%;
  background: var(--surface-4);
  border-radius: 2px;
  min-width: 2px;
  transition: width 0.4s var(--ease-out);
}

.bar-fill--top { background: var(--border-focus); }

.bar-item__value {
  font-size: var(--text-xs);
  color: var(--text-3);
  text-align: right;
  font-variant-numeric: tabular-nums;
  font-family: var(--font-mono);
}


/* ══════════════════════════════════════════════════════════════════════════════
   STAT CARD (summary row)
   ══════════════════════════════════════════════════════════════════════════════ */

.stat-row {
  display: flex;
  gap: var(--sp-4);
}

.stat-card {
  flex: 1;
  padding: var(--sp-4);
  background: var(--surface-1);
  border: 1px solid var(--border);
  border-radius: var(--r-md);
  display: flex;
  flex-direction: column;
  gap: var(--sp-1);
}

.stat-card__label {
  font-size: var(--text-xs);
  font-weight: var(--weight-semi);
  letter-spacing: 0.06em;
  text-transform: uppercase;
  color: var(--text-3);
}

.stat-card__value {
  font-size: var(--text-xl);
  font-weight: var(--weight-bold);
  color: var(--text-1);
  font-variant-numeric: tabular-nums;
  letter-spacing: -0.02em;
}

.stat-card__sub {
  font-size: var(--text-xs);
  color: var(--text-3);
}


/* ══════════════════════════════════════════════════════════════════════════════
   DROPDOWN / SELECT
   ══════════════════════════════════════════════════════════════════════════════ */

.select-wrap { position: relative; display: inline-block; }

.select-wrap select {
  appearance: none;
  padding: 0 var(--sp-8) 0 var(--sp-3);
  height: 34px;
  background: var(--surface-2);
  border: 1px solid var(--border-strong);
  border-radius: var(--r-sm);
  font-size: var(--text-base);
  color: var(--text-1);
  cursor: pointer;
  transition: border-color var(--dur-base);
}

.select-wrap select:hover { border-color: var(--surface-4); }
.select-wrap select:focus { outline: none; border-color: var(--border-focus); }

.select-wrap::after {
  content: '▾';
  position: absolute;
  right: var(--sp-3);
  top: 50%;
  transform: translateY(-50%);
  color: var(--text-3);
  font-size: 11px;
  pointer-events: none;
}
